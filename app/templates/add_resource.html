<!-- extend base layout -->
{% extends "base.html" %}

{% block content %}
<body id = "add_p">
  <div class="row">
      <h1 class="page-header">{{ title }}</h1>
      <hr align="center">
  </div>

	<form action="" method="POST" role="form" name="submit_food_resource">
	    {{ form.hidden_tag() }}

	    <!-- Food Resource Name -->
	    <div class="row">
		    <div class="large-8 medium-6 medium-centered small-12 columns large-centered 
		    	medium-centered">
		        	{% if additional_errors %}
		                {% for e in additional_errors %}
		                    {% if e %}
		                        <small class="error">{{ e }}</small>
		                    {% endif %}
		                {% endfor %}
		            {% endif %}
		      	</label>
		    </div>
		</div>

	   <!-- Food Resource Type -->
	    {% set field = form.name %}
	    <div class="row">
		    <div class="large-8 medium-8 medium-centered small-8 small-centered
		     columns large-centered">
		      	<label>{{ form.name.label }}
		      		<dd class="error">{{ form.name()|safe }}
		            {% if field.errors %}
		                {% for e in field.errors %}
		                    {% if e %}
		                        <small class="error">{{ e }}</small>
		                    {% endif %}
		                {% endfor %}
		            {% endif %}
	            </label>
			</div>
		</div>

		<!-- Food Resource Type -->
		{% set field = form.location_type %}
		<div class="row">
		    <div class="large-8 medium-8 medium-centered small-8 small-centered
		     columns large-centered">
		      	<label>{{ form.location_type.label }}
		        	<dd class="error">{{ form.location_type()|safe }}
		        	{% if field.errors %}
		                {% for e in field.errors %}
		                    {% if e %}
		                        <small class="error">{{ e }}</small>
		                    {% endif %}
		                {% endfor %}
		            {% endif %}
				</label>
			</div>
		</div>

		<!-- Address Line 1 -->
		{% set field = form.address_line1 %}
	    <div class="row">
		    <div class="large-8 medium-8 medium-centered small-8 small-centered
		     columns large-centered">
		      	<label>{{ form.address_line1.label }}
		        	<dd class="error">{{ form.address_line1()|safe }}
		        	{% if field.errors %}
		                {% for e in field.errors %}
		                    {% if e %}
		                        <small class="error">{{ e }}</small>
		                    {% endif %}
		                {% endfor %}
		            {% endif %}
				</label>
			</div>
		</div>

	  <!-- Address Line 2 -->
		{% set field = form.address_line2 %}
		<div class="row">
		    <div class="large-8 medium-8 medium-centered small-8 small-centered
		     columns large-centered">
		      	<label>{{ form.address_line2.label }}
		        	<dd class="error">{{ form.address_line2()|safe }}
		        	{% if field.errors %}
		                {% for e in field.errors %}
		                    {% if e %}
		                        <small class="error">{{ e }}</small>
		                    {% endif %}
		                {% endfor %}
		            {% endif %}
				</label>
			</div>
		</div>

		<!-- Address City --> 
		{% set field = form.address_city %}
		<div class="row">
			<div class="large-8 medium-8 medium-centered small-8 small-centered
		     columns large-centered">
		      	<label>{{ form.address_city.label }}
		        	<dd class="error">{{ form.address_city()|safe }}
		        	{% if field.errors %}
		                {% for e in field.errors %}
		                    {% if e %}
		                        <small class="error">{{ e }}</small>
		                    {% endif %}
		                {% endfor %}
		            {% endif %}
				</label>
			</div>
		</div>

		<!-- Address State --> 
		{% set field = form.address_state %}
		<div class="row">
		    <div class="large-8 medium-8 medium-centered small-8 small-centered
		     columns large-centered">
		      	<label>{{ form.address_state.label }}
		        	<dd class="error">{{ form.address_state()|safe }}
		        	{% if field.errors %}
		                {% for e in field.errors %}
		                    {% if e %}
		                        <small class="error">{{ e }}</small>
		                    {% endif %}
		                {% endfor %}
		            {% endif %}
				</label>
			</div>
		</div>

		<!-- Address Zip Code --> 
		{% set field = form.address_zip_code %}
		<div class="row">
		    <div class="large-8 medium-8 medium-centered small-8 small-centered
		     columns large-centered">
		      	<label>{{ form.address_zip_code.label }}
		        	<dd class="error">{{ form.address_zip_code()|safe }}
		        	{% if field.errors %}
		                {% for e in field.errors %}
		                    {% if e %}
		                        <small class="error">{{ e }}</small>
		                    {% endif %}
		                {% endfor %}
		            {% endif %}
				</label>
			</div>
		</div>

		<!-- Address Phone Number --> 
		{% set field = form.phone_number %}
		<div class="row">
		    <div class="large-8 medium-8 medium-centered small-8 small-centered
		     columns large-centered">
		      	<label>{{ form.phone_number.label }}
		        	<dd class="error">{{ form.phone_number()|safe }}
		        	{% if field.errors %}
		                {% for e in field.errors %}
		                    {% if e %}
		                        <small class="error">{{ e }}</small>
		                    {% endif %}
		                {% endfor %}
		            {% endif %}
				</label>
			</div>
		</div>

		<!-- Website --> 
		{% set field = form.website %}
		<div class="row">
		    <div class="large-8 medium-8 medium-centered small-8 small-centered
		     columns large-centered">
		      	<label>{{ form.website.label }}
		        	<dd class="error">{{ form.website()|safe }}
		        	{% if field.errors %}
		                {% for e in field.errors %}
		                    {% if e %}
		                        <small class="error">{{ e }}</small>
		                    {% endif %}
		                {% endfor %}
		            {% endif %}
				</label>
			</div>
		</div>

		<div class="row">
		    <div class="large-8 medium-8 medium-centered small-8 small-centered
		     columns large-centered">
		      	<label>Days/Hours of Operation
				</label>
			</div>
		</div>

		{% set field = form.are_hours_available %}
		<div class="row">
		    <div class="large-8 medium-8 medium-centered small-8 small-centered
		     columns large-centered">
		      	<label>{{ form.are_hours_available.label }}
		        	<dd class="error">{{ form.are_hours_available()|safe }}
		        	{% if field.errors %}
		                {% for e in field.errors %}
		                    {% if e %}
		                        <small class="error">{{ e }}</small>
		                    {% endif %}
		                {% endfor %}
		            {% endif %}
				</label>
			</div>
		</div>

		{% for child in form.is_open %}
			{% set field=child.is_open %}
				<div class="row">
				    <div class="large-8 medium-8 medium-centered small-8 small-centered
				     columns large-centered">
				      	<label>{{ field.label }}
				        	<dd class="error">{{ field()|safe }}
				        	{% if field.errors %}
				                {% for e in field.errors %}
				                    {% if e %}
				                        <small class="error">{{ e }}</small>
				                    {% endif %}
				                {% endfor %}
				            {% endif %}
						</label>
					</div>
				</div>
		{% endfor %}

		<!-- Iterate through list of 7 MultiTimeSlotForms -->
		{% for multi_timeslot_form in form.daily_timeslots %}  
			<!-- Iterate through list of TimeSlotForms --> 
			{% for timeslot_form in multi_timeslot_form.timeslots %} 
				{{ timeslot_form.opens_at() }}
				{{ timeslot_form.closes_at() }}
	      	{% endfor %}
    	{% endfor %} 

		{% for day_of_week in days_of_week %}

		<div class="row open-or-closed-container">
		    <div class="large-8 medium-8 medium-centered small-8 small-centered
		     columns large-centered">
		    	<div class="row">
		      		<div class="large-4 small-4 columns" id="middle-padding-section">
		      			<label>{{ day_of_week.name }}
					    	<select name='{{ day_of_week.index }}-open-or-closed' class='open-or-closed'>
					    		<option value="closed">Closed</option>
								<option value="open">Open</option>
					    	</select>
		      			</label>
		      		</div>
		      		<div class="large-8 small-8 columns" id="middle-padding-section">
			      		<div class="row">
				      		<div class="large-6 small-6 columns {{ day_of_week.index }}-time-picker" id="middle-padding-section">
				      			<label>Opens at
							    	<select name='{{ day_of_week.index }}-opening-time'>
							    		{% for time in possible_opening_times %}
							    			<option value="{{ time.strftime('%H') }}:{{ time.strftime('%M') }}">
							    				{{ time.strftime('%I') }}:{{ time.strftime('%M') }} {{ time.strftime('%p') }}
							    			</option>
							    		{% endfor %}
							    	</select>
				      			</label>
				      		</div>
				      		<div class="large-6 small-6 columns {{ day_of_week.index }}-time-picker" id="middle-padding-section">
				      			<label>Closes at
							    	<select name='{{ day_of_week.index }}-closing-time'>
							    		{% for time in possible_closing_times %}
							    			<option value="{{ time.strftime('%H') }}:{{ time.strftime('%M') }}">
							    				{{ time.strftime('%I') }}:{{ time.strftime('%M') }} {{ time.strftime('%p') }}
							    			</option>
							    		{% endfor %}
							    	</select>
				      			</label>
				      		</div>
				      	</div>
				      	<div class="row {{ day_of_week.index }}-add-another-time-picker">
				      		<div class="small-12 columns">
				      			Add another timeslot
				      		</div>
				      	</div>
		      		</div>
		      	</div>
	   	  </div>
		</div>

		{% endfor %}

		{% set field = form.additional_information %}
		<div class="row">
		    <div class="large-8 medium-8 medium-centered small-8 small-centered
		     columns large-centered" id="top-padding-section">
		      	<label>{{ form.additional_information.label }}
		        	<dd class="error">{{ form.additional_information()|safe }}
		        	{% if field.errors %}
		                {% for e in field.errors %}
		                    {% if e %}
		                        <small class="error">{{ e }}</small>
		                    {% endif %}
		                {% endfor %}
		            {% endif %}
		      	</label>
		    </div>
		</div>

		{% set field = form.is_for_family_and_children %}
		<div class="row">
		    <div class="large-8 medium-8 medium-centered small-8 small-centered
		     columns large-centered" id="top-padding-section">
		      	<label>{{ form.is_for_family_and_children.label }}
		        	<dd class="error">{{ form.is_for_family_and_children()|safe }}
		        	{% if field.errors %}
		                {% for e in field.errors %}
		                    {% if e %}
		                        <small class="error">{{ e }}</small>
		                    {% endif %}
		                {% endfor %}
		            {% endif %}
		      	</label>
		    </div>
		</div>

		{% set field = form.is_for_seniors %}
		<div class="row">
		    <div class="large-8 medium-8 medium-centered small-8 small-centered
		     columns large-centered" id="top-padding-section">
		      	<label>{{ form.is_for_seniors.label }}
		        	<dd class="error">{{ form.is_for_seniors()|safe }}
		        	{% if field.errors %}
		                {% for e in field.errors %}
		                    {% if e %}
		                        <small class="error">{{ e }}</small>
		                    {% endif %}
		                {% endfor %}
		            {% endif %}
		      	</label>
		    </div>
		</div>

		{% set field = form.is_wheelchair_accessible %}
		<div class="row">
		    <div class="large-8 medium-8 medium-centered small-8 small-centered
		     columns large-centered" id="top-padding-section">
		      	<label>{{ form.is_wheelchair_accessible.label }}
		        	<dd class="error">{{ form.is_wheelchair_accessible()|safe }}
		        	{% if field.errors %}
		                {% for e in field.errors %}
		                    {% if e %}
		                        <small class="error">{{ e }}</small>
		                    {% endif %}
		                {% endfor %}
		            {% endif %}
		      	</label>
		    </div>
		</div>

		{% set field = form.is_accepts_snap %}
		<div class="row">
		    <div class="large-8 medium-8 medium-centered small-8 small-centered
		     columns large-centered" id="top-padding-section">
		      	<label>{{ form.is_accepts_snap.label }}
		        	<dd class="error">{{ form.is_accepts_snap()|safe }}
		        	{% if field.errors %}
		                {% for e in field.errors %}
		                    {% if e %}
		                        <small class="error">{{ e }}</small>
		                    {% endif %}
		                {% endfor %}
		            {% endif %}
		      	</label>
		    </div>
		</div>

		<div class="row">
		    <div class="large-8 medium-8 medium-centered small-8 small-centered
		     columns large-centered" id="bottom-padding-section">
	          <input type=submit class="button radius small" value=Submit>
		    </div>
		</div>
	</form>
</body>

<script>
	$(document).ready(function() {

		// Set food resource timeslots.
		var dayOfWeekId, openOrClosedSelectorName, openingTimeSelectorName, 
			closingTimeSelectorName; 

		// Set timeslot drop-downs dynamically. The Flask form cannot 
		// automatically pre-load the drop-downs.
		{% for timeslot in timeslots %}
			dayOfWeekId = {{ timeslot.day_of_week }};
			openingTimeString = "{{ timeslot.start_time.strftime('%H') }}"
				+ ":" + "{{ timeslot.start_time.strftime('%M') }}";
			closingTimeString = "{{ timeslot.end_time.strftime('%H') }}"
				+ ":" + "{{ timeslot.end_time.strftime('%M') }}";

			openOrClosedSelectorName = dayOfWeekId + "-open-or-closed";
			openingTimeSelectorName = dayOfWeekId + "-opening-time";
			closingTimeSelectorName = dayOfWeekId + "-closing-time";

			$('[name="' + openOrClosedSelectorName + '"]').val("open");
			$('[name="' + openingTimeSelectorName + '"]').val(openingTimeString);
			$('[name="' + closingTimeSelectorName + '"]').val(closingTimeString);
			$("." + dayOfWeekId + "-time-picker").show();
		{% endfor %}

		// Set food resource type drop-down dynamically. The Flask form cannot
		// automatically pre-load the drop-downs.
		{% if food_resource_type %}
			var foodResourceTypeString = "{{ food_resource_type }}";
			$('[name="food-resource-type"]').val(foodResourceTypeString);
		{% endif %}

		// Set "Are hours available?" drop-down dynamically. The Flask form 
		// cannot automatically pre-load the drop-downs. 
		{% if are_hours_available %}
			$('select#are-hours-available-picker').val("yes"); 
			$(".open-or-closed-container").show();
		{% else %}
			$('select#are-hours-available-picker').val("no");
			$(".open-or-closed-container").hide();
		{% endif %}
	}); 
</script>

{% endblock %}
